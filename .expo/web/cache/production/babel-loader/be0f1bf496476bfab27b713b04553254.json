{"ast":null,"code":"import _extends from\"@babel/runtime/helpers/extends\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from'react';import invariant from\"../../utils/invariant\";var MIN_POSITION_OFFSET=0.01;export default function createPointerEventsContainer(Component){var Container=function(_React$Component){_inherits(Container,_React$Component);var _super=_createSuper(Container);function Container(props,context){var _this;_classCallCheck(this,Container);_this=_super.call(this,props,context);_this._onComponentRef=function(component){_this._component=component;if(component){invariant(typeof component.setNativeProps==='function','component must implement method `setNativeProps`');}};_this._onPositionChange=function(){if(_this._component){var pointerEvents=_this._computePointerEvents();if(_this._pointerEvents!==pointerEvents){_this._pointerEvents=pointerEvents;_this._component.setNativeProps({pointerEvents:pointerEvents});}}};_this._pointerEvents=_this._computePointerEvents();return _this;}_createClass(Container,[{key:\"componentWillUnmount\",value:function componentWillUnmount(){this._positionListener&&this._positionListener.remove();}},{key:\"render\",value:function render(){this._bindPosition();this._pointerEvents=this._computePointerEvents();return React.createElement(Component,_extends({},this.props,{pointerEvents:this._pointerEvents,onComponentRef:this._onComponentRef}));}},{key:\"_bindPosition\",value:function _bindPosition(){this._positionListener&&this._positionListener.remove();this._positionListener=new AnimatedValueSubscription(this.props.position,this._onPositionChange);}},{key:\"_computePointerEvents\",value:function _computePointerEvents(){var _this$props=this.props,navigation=_this$props.navigation,position=_this$props.position,scene=_this$props.scene;if(scene.isStale||navigation.state.index!==scene.index){return scene.index>navigation.state.index?'box-only':'none';}var offset=position.__getAnimatedValue()-navigation.state.index;if(Math.abs(offset)>MIN_POSITION_OFFSET){return'box-only';}return'auto';}}]);return Container;}(React.Component);return Container;}var AnimatedValueSubscription=function(){function AnimatedValueSubscription(value,callback){_classCallCheck(this,AnimatedValueSubscription);this._value=value;this._token=value.addListener(callback);}_createClass(AnimatedValueSubscription,[{key:\"remove\",value:function remove(){this._value.removeListener(this._token);}}]);return AnimatedValueSubscription;}();","map":{"version":3,"sources":["E:/photofeed/node_modules/react-navigation-stack/dist/views/StackView/createPointerEventsContainer.js"],"names":["React","invariant","MIN_POSITION_OFFSET","createPointerEventsContainer","Component","Container","props","context","_onComponentRef","component","_component","setNativeProps","_onPositionChange","pointerEvents","_computePointerEvents","_pointerEvents","_positionListener","remove","_bindPosition","AnimatedValueSubscription","position","navigation","scene","isStale","state","index","offset","__getAnimatedValue","Math","abs","value","callback","_value","_token","addListener","removeListener"],"mappings":"qjCAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,SAAP,6BAEA,GAAMC,CAAAA,mBAAmB,CAAG,IAA5B,CAOA,cAAe,SAASC,CAAAA,4BAAT,CAAsCC,SAAtC,CAAiD,IACxDC,CAAAA,SADwD,qGAE5D,mBAAYC,KAAZ,CAAmBC,OAAnB,CAA4B,2CAC1B,uBAAMD,KAAN,CAAaC,OAAb,EAD0B,MAgB5BC,eAhB4B,CAgBV,SAAAC,SAAS,CAAI,CAC7B,MAAKC,UAAL,CAAkBD,SAAlB,CACA,GAAIA,SAAJ,CAAe,CACbR,SAAS,CAAC,MAAOQ,CAAAA,SAAS,CAACE,cAAjB,GAAoC,UAArC,CAAiD,kDAAjD,CAAT,CACD,CACF,CArB2B,OA4B5BC,iBA5B4B,CA4BR,UAAM,CACxB,GAAI,MAAKF,UAAT,CAAqB,CACnB,GAAMG,CAAAA,aAAa,CAAG,MAAKC,qBAAL,EAAtB,CACA,GAAI,MAAKC,cAAL,GAAwBF,aAA5B,CAA2C,CACzC,MAAKE,cAAL,CAAsBF,aAAtB,CACA,MAAKH,UAAL,CAAgBC,cAAhB,CAA+B,CAAEE,aAAa,CAAbA,aAAF,CAA/B,EACD,CACF,CACF,CApC2B,CAE1B,MAAKE,cAAL,CAAsB,MAAKD,qBAAL,EAAtB,CAF0B,aAG3B,CAL2D,yFAOrC,CACrB,KAAKE,iBAAL,EAA0B,KAAKA,iBAAL,CAAuBC,MAAvB,EAA1B,CACD,CAT2D,uCAWnD,CACP,KAAKC,aAAL,GACA,KAAKH,cAAL,CAAsB,KAAKD,qBAAL,EAAtB,CAEA,MAAO,qBAAC,SAAD,aAAe,KAAKR,KAApB,EAA2B,aAAa,CAAE,KAAKS,cAA/C,CAA+D,cAAc,CAAE,KAAKP,eAApF,GAAP,CACD,CAhB2D,qDAyB5C,CACd,KAAKQ,iBAAL,EAA0B,KAAKA,iBAAL,CAAuBC,MAAvB,EAA1B,CACA,KAAKD,iBAAL,CAAyB,GAAIG,CAAAA,yBAAJ,CAA8B,KAAKb,KAAL,CAAWc,QAAzC,CAAmD,KAAKR,iBAAxD,CAAzB,CACD,CA5B2D,qEAwCpC,iBACkB,KAAKN,KADvB,CACde,UADc,aACdA,UADc,CACFD,QADE,aACFA,QADE,CACQE,KADR,aACQA,KADR,CAGtB,GAAIA,KAAK,CAACC,OAAN,EAAiBF,UAAU,CAACG,KAAX,CAAiBC,KAAjB,GAA2BH,KAAK,CAACG,KAAtD,CAA6D,CAE3D,MAAOH,CAAAA,KAAK,CAACG,KAAN,CAAcJ,UAAU,CAACG,KAAX,CAAiBC,KAA/B,CAAuC,UAAvC,CAAoD,MAA3D,CACD,CAED,GAAMC,CAAAA,MAAM,CAAGN,QAAQ,CAACO,kBAAT,GAAgCN,UAAU,CAACG,KAAX,CAAiBC,KAAhE,CACA,GAAIG,IAAI,CAACC,GAAL,CAASH,MAAT,EAAmBxB,mBAAvB,CAA4C,CAI1C,MAAO,UAAP,CACD,CAED,MAAO,MAAP,CACD,CAzD2D,uBACtCF,KAAK,CAACI,SADgC,EA2D9D,MAAOC,CAAAA,SAAP,CACD,C,GAEKc,CAAAA,yB,YACJ,mCAAYW,KAAZ,CAAmBC,QAAnB,CAA6B,iDAC3B,KAAKC,MAAL,CAAcF,KAAd,CACA,KAAKG,MAAL,CAAcH,KAAK,CAACI,WAAN,CAAkBH,QAAlB,CAAd,CACD,C,6EAEQ,CACP,KAAKC,MAAL,CAAYG,cAAZ,CAA2B,KAAKF,MAAhC,EACD,C","sourcesContent":["import React from 'react';\nimport invariant from '../../utils/invariant';\n\nconst MIN_POSITION_OFFSET = 0.01;\n\n/**\n * Create a higher-order component that automatically computes the\n * `pointerEvents` property for a component whenever navigation position\n * changes.\n */\nexport default function createPointerEventsContainer(Component) {\n  class Container extends React.Component {\n    constructor(props, context) {\n      super(props, context);\n      this._pointerEvents = this._computePointerEvents();\n    }\n\n    componentWillUnmount() {\n      this._positionListener && this._positionListener.remove();\n    }\n\n    render() {\n      this._bindPosition();\n      this._pointerEvents = this._computePointerEvents();\n\n      return <Component {...this.props} pointerEvents={this._pointerEvents} onComponentRef={this._onComponentRef} />;\n    }\n\n    _onComponentRef = component => {\n      this._component = component;\n      if (component) {\n        invariant(typeof component.setNativeProps === 'function', 'component must implement method `setNativeProps`');\n      }\n    };\n\n    _bindPosition() {\n      this._positionListener && this._positionListener.remove();\n      this._positionListener = new AnimatedValueSubscription(this.props.position, this._onPositionChange);\n    }\n\n    _onPositionChange = () => {\n      if (this._component) {\n        const pointerEvents = this._computePointerEvents();\n        if (this._pointerEvents !== pointerEvents) {\n          this._pointerEvents = pointerEvents;\n          this._component.setNativeProps({ pointerEvents });\n        }\n      }\n    };\n\n    _computePointerEvents() {\n      const { navigation, position, scene } = this.props;\n\n      if (scene.isStale || navigation.state.index !== scene.index) {\n        // The scene isn't focused.\n        return scene.index > navigation.state.index ? 'box-only' : 'none';\n      }\n\n      const offset = position.__getAnimatedValue() - navigation.state.index;\n      if (Math.abs(offset) > MIN_POSITION_OFFSET) {\n        // The positon is still away from scene's index.\n        // Scene's children should not receive touches until the position\n        // is close enough to scene's index.\n        return 'box-only';\n      }\n\n      return 'auto';\n    }\n  }\n  return Container;\n}\n\nclass AnimatedValueSubscription {\n  constructor(value, callback) {\n    this._value = value;\n    this._token = value.addListener(callback);\n  }\n\n  remove() {\n    this._value.removeListener(this._token);\n  }\n}"]},"metadata":{},"sourceType":"module"}