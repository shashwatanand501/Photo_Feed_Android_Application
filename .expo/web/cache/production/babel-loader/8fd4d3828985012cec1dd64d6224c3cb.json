{"ast":null,"code":"import _extends from\"@babel/runtime/helpers/extends\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import*as React from'react';import PropTypes from'prop-types';import Animated from\"react-native-web/dist/exports/Animated\";import PanResponder from\"react-native-web/dist/exports/PanResponder\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import View from\"react-native-web/dist/exports/View\";import Platform from\"react-native-web/dist/exports/Platform\";import{PagerRendererPropType}from\"./TabViewPropTypes\";var DEAD_ZONE=12;var DefaultTransitionSpec={timing:Animated.spring,tension:300,friction:35};var TabViewPagerPan=function(_React$Component){_inherits(TabViewPagerPan,_React$Component);var _super=_createSuper(TabViewPagerPan);function TabViewPagerPan(props){var _this;_classCallCheck(this,TabViewPagerPan);_this=_super.call(this,props);_this._isMovingHorizontally=function(evt,gestureState){return Math.abs(gestureState.dx)>Math.abs(gestureState.dy*2)&&Math.abs(gestureState.vx)>Math.abs(gestureState.vy*2);};_this._canMoveScreen=function(evt,gestureState){if(_this.props.swipeEnabled===false){return false;}var routes=_this.props.navigationState.routes;return _this._isMovingHorizontally(evt,gestureState)&&(gestureState.dx>=DEAD_ZONE&&_this._currentIndex>0||gestureState.dx<=-DEAD_ZONE&&_this._currentIndex<routes.length-1);};_this._startGesture=function(){_this.props.onSwipeStart&&_this.props.onSwipeStart();_this.props.panX.stopAnimation();};_this._respondToGesture=function(evt,gestureState){var _this$props$navigatio=_this.props.navigationState,routes=_this$props$navigatio.routes,index=_this$props$navigatio.index;if(gestureState.dx>0&&index<=0||gestureState.dx<0&&index>=routes.length-1){return;}_this.props.panX.setValue(gestureState.dx);};_this._finishGesture=function(evt,gestureState){var _this$props=_this.props,navigationState=_this$props.navigationState,layout=_this$props.layout,_this$props$swipeDist=_this$props.swipeDistanceThreshold,swipeDistanceThreshold=_this$props$swipeDist===void 0?layout.width/1.75:_this$props$swipeDist;var _this$props$swipeVelo=_this.props.swipeVelocityThreshold,swipeVelocityThreshold=_this$props$swipeVelo===void 0?0.15:_this$props$swipeVelo;_this.props.onSwipeEnd&&_this.props.onSwipeEnd();if(Platform.OS==='android'){swipeVelocityThreshold/=1000000;}var currentIndex=typeof _this._pendingIndex==='number'?_this._pendingIndex:_this._currentIndex;var nextIndex=currentIndex;if(Math.abs(gestureState.dx)>Math.abs(gestureState.dy)&&Math.abs(gestureState.vx)>Math.abs(gestureState.vy)&&(Math.abs(gestureState.dx)>swipeDistanceThreshold||Math.abs(gestureState.vx)>swipeVelocityThreshold)){nextIndex=Math.round(Math.min(Math.max(0,currentIndex-gestureState.dx/Math.abs(gestureState.dx)),navigationState.routes.length-1));_this._currentIndex=nextIndex;}if(!isFinite(nextIndex)||!_this.props.canJumpToTab(_this.props.navigationState.routes[nextIndex])){nextIndex=currentIndex;}_this._transitionTo(nextIndex);};_this._transitionTo=function(index){var animated=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var offset=-index*_this.props.layout.width;if(_this.props.animationEnabled===false||animated===false){_this.props.panX.setValue(0);_this.props.offsetX.setValue(offset);return;}var timing=DefaultTransitionSpec.timing,transitionConfig=_objectWithoutProperties(DefaultTransitionSpec,[\"timing\"]);Animated.parallel([timing(_this.props.panX,_objectSpread(_objectSpread({},transitionConfig),{},{toValue:0})),timing(_this.props.offsetX,_objectSpread(_objectSpread({},transitionConfig),{},{toValue:offset}))]).start(function(_ref){var finished=_ref.finished;if(finished){var route=_this.props.navigationState.routes[index];_this.props.jumpTo(route.key);_this.props.onAnimationEnd&&_this.props.onAnimationEnd();_this._pendingIndex=null;}});_this._pendingIndex=index;};_this._currentIndex=_this.props.navigationState.index;return _this;}_createClass(TabViewPagerPan,[{key:\"componentWillMount\",value:function componentWillMount(){this._panResponder=PanResponder.create({onMoveShouldSetPanResponder:this._canMoveScreen,onMoveShouldSetPanResponderCapture:this._canMoveScreen,onPanResponderGrant:this._startGesture,onPanResponderMove:this._respondToGesture,onPanResponderTerminate:this._finishGesture,onPanResponderRelease:this._finishGesture,onPanResponderTerminationRequest:function onPanResponderTerminationRequest(){return true;}});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){this._currentIndex=this.props.navigationState.index;if(prevProps.navigationState.routes!==this.props.navigationState.routes||prevProps.layout.width!==this.props.layout.width){this._transitionTo(this.props.navigationState.index,false);}else if(prevProps.navigationState.index!==this.props.navigationState.index){this._transitionTo(this.props.navigationState.index);}}},{key:\"render\",value:function render(){var _this$props2=this.props,panX=_this$props2.panX,offsetX=_this$props2.offsetX,navigationState=_this$props2.navigationState,layout=_this$props2.layout,children=_this$props2.children;var width=layout.width;var routes=navigationState.routes;var maxTranslate=width*(routes.length-1);var translateX=Animated.add(panX,offsetX).interpolate({inputRange:[-maxTranslate,0],outputRange:[-maxTranslate,0],extrapolate:'clamp'});return React.createElement(Animated.View,_extends({style:[styles.sheet,width?{width:routes.length*width,transform:[{translateX:translateX}]}:null]},this._panResponder.panHandlers),React.Children.map(children,function(child,i){return React.createElement(View,{key:navigationState.routes[i].key,testID:navigationState.routes[i].testID,style:width?{width:width}:i===navigationState.index?StyleSheet.absoluteFill:null},i===navigationState.index||width?child:null);}));}}]);return TabViewPagerPan;}(React.Component);TabViewPagerPan.propTypes=_objectSpread(_objectSpread({},PagerRendererPropType),{},{swipeDistanceThreshold:PropTypes.number,swipeVelocityThreshold:PropTypes.number});TabViewPagerPan.defaultProps={canJumpToTab:function canJumpToTab(){return true;},initialLayout:{height:0,width:0}};export{TabViewPagerPan as default};var styles=StyleSheet.create({sheet:{flex:1,flexDirection:'row',alignItems:'stretch'}});","map":{"version":3,"sources":["E:/photofeed/node_modules/react-native-tab-view/src/TabViewPagerPan.js"],"names":["React","PropTypes","PagerRendererPropType","DEAD_ZONE","DefaultTransitionSpec","timing","Animated","spring","tension","friction","TabViewPagerPan","props","_isMovingHorizontally","evt","gestureState","Math","abs","dx","dy","vx","vy","_canMoveScreen","swipeEnabled","routes","navigationState","_currentIndex","length","_startGesture","onSwipeStart","panX","stopAnimation","_respondToGesture","index","setValue","_finishGesture","layout","swipeDistanceThreshold","width","swipeVelocityThreshold","onSwipeEnd","Platform","OS","currentIndex","_pendingIndex","nextIndex","round","min","max","isFinite","canJumpToTab","_transitionTo","animated","offset","animationEnabled","offsetX","transitionConfig","parallel","toValue","start","finished","route","jumpTo","key","onAnimationEnd","_panResponder","PanResponder","create","onMoveShouldSetPanResponder","onMoveShouldSetPanResponderCapture","onPanResponderGrant","onPanResponderMove","onPanResponderTerminate","onPanResponderRelease","onPanResponderTerminationRequest","prevProps","children","maxTranslate","translateX","add","interpolate","inputRange","outputRange","extrapolate","styles","sheet","transform","panHandlers","Children","map","child","i","testID","StyleSheet","absoluteFill","Component","propTypes","number","defaultProps","initialLayout","height","flex","flexDirection","alignItems"],"mappings":"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","sourcesContent":["/* @flow */\n\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  Animated,\n  PanResponder,\n  StyleSheet,\n  View,\n  Platform,\n} from 'react-native';\nimport { PagerRendererPropType } from './TabViewPropTypes';\nimport type { PagerRendererProps } from './TabViewTypeDefinitions';\n\ntype GestureEvent = {\n  nativeEvent: {\n    changedTouches: Array<*>,\n    identifier: number,\n    locationX: number,\n    locationY: number,\n    pageX: number,\n    pageY: number,\n    target: number,\n    timestamp: number,\n    touches: Array<*>,\n  },\n};\n\ntype GestureState = {\n  stateID: number,\n  moveX: number,\n  moveY: number,\n  x0: number,\n  y0: number,\n  dx: number,\n  dy: number,\n  vx: number,\n  vy: number,\n  numberActiveTouches: number,\n};\n\ntype Props<T> = PagerRendererProps<T> & {\n  swipeDistanceThreshold?: number,\n  swipeVelocityThreshold?: number,\n  onSwipeStart?: () => mixed,\n  onSwipeEnd?: () => mixed,\n  onAnimationEnd?: () => mixed,\n};\n\nconst DEAD_ZONE = 12;\n\nconst DefaultTransitionSpec = {\n  timing: Animated.spring,\n  tension: 300,\n  friction: 35,\n};\n\nexport default class TabViewPagerPan<T: *> extends React.Component<Props<T>> {\n  static propTypes = {\n    ...PagerRendererPropType,\n    swipeDistanceThreshold: PropTypes.number,\n    swipeVelocityThreshold: PropTypes.number,\n  };\n\n  static defaultProps = {\n    canJumpToTab: () => true,\n    initialLayout: {\n      height: 0,\n      width: 0,\n    },\n  };\n\n  constructor(props: Props<T>) {\n    super(props);\n    this._currentIndex = this.props.navigationState.index;\n  }\n\n  componentWillMount() {\n    this._panResponder = PanResponder.create({\n      onMoveShouldSetPanResponder: this._canMoveScreen,\n      onMoveShouldSetPanResponderCapture: this._canMoveScreen,\n      onPanResponderGrant: this._startGesture,\n      onPanResponderMove: this._respondToGesture,\n      onPanResponderTerminate: this._finishGesture,\n      onPanResponderRelease: this._finishGesture,\n      onPanResponderTerminationRequest: () => true,\n    });\n  }\n\n  componentDidUpdate(prevProps: Props<T>) {\n    this._currentIndex = this.props.navigationState.index;\n\n    if (\n      prevProps.navigationState.routes !== this.props.navigationState.routes ||\n      prevProps.layout.width !== this.props.layout.width\n    ) {\n      this._transitionTo(this.props.navigationState.index, false);\n    } else if (\n      prevProps.navigationState.index !== this.props.navigationState.index\n    ) {\n      this._transitionTo(this.props.navigationState.index);\n    }\n  }\n\n  _currentIndex: number;\n\n  _isMovingHorizontally = (evt: GestureEvent, gestureState: GestureState) => {\n    return (\n      Math.abs(gestureState.dx) > Math.abs(gestureState.dy * 2) &&\n      Math.abs(gestureState.vx) > Math.abs(gestureState.vy * 2)\n    );\n  };\n\n  _canMoveScreen = (evt: GestureEvent, gestureState: GestureState) => {\n    if (this.props.swipeEnabled === false) {\n      return false;\n    }\n\n    const { navigationState: { routes } } = this.props;\n\n    return (\n      this._isMovingHorizontally(evt, gestureState) &&\n      ((gestureState.dx >= DEAD_ZONE && this._currentIndex > 0) ||\n        (gestureState.dx <= -DEAD_ZONE &&\n          this._currentIndex < routes.length - 1))\n    );\n  };\n\n  _startGesture = () => {\n    this.props.onSwipeStart && this.props.onSwipeStart();\n    this.props.panX.stopAnimation();\n  };\n\n  _respondToGesture = (evt: GestureEvent, gestureState: GestureState) => {\n    const { navigationState: { routes, index } } = this.props;\n\n    if (\n      // swiping left\n      (gestureState.dx > 0 && index <= 0) ||\n      // swiping right\n      (gestureState.dx < 0 && index >= routes.length - 1)\n    ) {\n      return;\n    }\n\n    this.props.panX.setValue(gestureState.dx);\n  };\n\n  _finishGesture = (evt: GestureEvent, gestureState: GestureState) => {\n    const {\n      navigationState,\n      layout,\n      swipeDistanceThreshold = layout.width / 1.75,\n    } = this.props;\n\n    let { swipeVelocityThreshold = 0.15 } = this.props;\n\n    this.props.onSwipeEnd && this.props.onSwipeEnd();\n\n    if (Platform.OS === 'android') {\n      // on Android, velocity is way lower due to timestamp being in nanosecond\n      // normalize it to have the same velocity on both iOS and Android\n      swipeVelocityThreshold /= 1000000;\n    }\n\n    const currentIndex =\n      typeof this._pendingIndex === 'number'\n        ? this._pendingIndex\n        : this._currentIndex;\n\n    let nextIndex = currentIndex;\n\n    if (\n      Math.abs(gestureState.dx) > Math.abs(gestureState.dy) &&\n      Math.abs(gestureState.vx) > Math.abs(gestureState.vy) &&\n      (Math.abs(gestureState.dx) > swipeDistanceThreshold ||\n        Math.abs(gestureState.vx) > swipeVelocityThreshold)\n    ) {\n      nextIndex = Math.round(\n        Math.min(\n          Math.max(\n            0,\n            currentIndex - gestureState.dx / Math.abs(gestureState.dx)\n          ),\n          navigationState.routes.length - 1\n        )\n      );\n\n      this._currentIndex = nextIndex;\n    }\n\n    if (\n      !isFinite(nextIndex) ||\n      !this.props.canJumpToTab(this.props.navigationState.routes[nextIndex])\n    ) {\n      nextIndex = currentIndex;\n    }\n\n    this._transitionTo(nextIndex);\n  };\n\n  _transitionTo = (index: number, animated: boolean = true) => {\n    const offset = -index * this.props.layout.width;\n\n    if (this.props.animationEnabled === false || animated === false) {\n      this.props.panX.setValue(0);\n      this.props.offsetX.setValue(offset);\n      return;\n    }\n\n    const { timing, ...transitionConfig } = DefaultTransitionSpec;\n\n    Animated.parallel([\n      timing(this.props.panX, {\n        ...transitionConfig,\n        toValue: 0,\n      }),\n      timing(this.props.offsetX, {\n        ...transitionConfig,\n        toValue: offset,\n      }),\n    ]).start(({ finished }) => {\n      if (finished) {\n        const route = this.props.navigationState.routes[index];\n        this.props.jumpTo(route.key);\n        this.props.onAnimationEnd && this.props.onAnimationEnd();\n        this._pendingIndex = null;\n      }\n    });\n\n    this._pendingIndex = index;\n  };\n\n  _panResponder: any;\n  _pendingIndex: ?number;\n\n  render() {\n    const { panX, offsetX, navigationState, layout, children } = this.props;\n    const { width } = layout;\n    const { routes } = navigationState;\n    const maxTranslate = width * (routes.length - 1);\n    const translateX = Animated.add(panX, offsetX).interpolate({\n      inputRange: [-maxTranslate, 0],\n      outputRange: [-maxTranslate, 0],\n      extrapolate: 'clamp',\n    });\n\n    return (\n      <Animated.View\n        style={[\n          styles.sheet,\n          width\n            ? {\n                width: routes.length * width,\n                transform: [{ translateX }],\n              }\n            : null,\n        ]}\n        {...this._panResponder.panHandlers}\n      >\n        {React.Children.map(children, (child, i) => (\n          <View\n            key={navigationState.routes[i].key}\n            testID={navigationState.routes[i].testID}\n            style={\n              width\n                ? { width }\n                : i === navigationState.index ? StyleSheet.absoluteFill : null\n            }\n          >\n            {i === navigationState.index || width ? child : null}\n          </View>\n        ))}\n      </Animated.View>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  sheet: {\n    flex: 1,\n    flexDirection: 'row',\n    alignItems: 'stretch',\n  },\n});\n"]},"metadata":{},"sourceType":"module"}