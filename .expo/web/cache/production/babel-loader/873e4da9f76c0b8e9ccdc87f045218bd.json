{"ast":null,"code":"import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";import _extends from\"@babel/runtime/helpers/extends\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from'react';import clamp from'clamp';import Animated from\"react-native-web/dist/exports/Animated\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import PanResponder from\"react-native-web/dist/exports/PanResponder\";import Platform from\"react-native-web/dist/exports/Platform\";import View from\"react-native-web/dist/exports/View\";import I18nManager from\"react-native-web/dist/exports/I18nManager\";import Easing from\"react-native-web/dist/exports/Easing\";import Dimensions from\"react-native-web/dist/exports/Dimensions\";import{SceneView,StackActions,NavigationActions,withOrientation,NavigationProvider}from'react-navigation';import Card from\"./StackViewCard\";import Header from\"../Header/Header\";import{ScreenContainer}from\"./screens\";import TransitionConfigs from\"./StackViewTransitionConfigs\";import{supportsImprovedSpringAnimation}from\"../../utils/ReactNativeFeatures\";var emptyFunction=function emptyFunction(){};var _Dimensions$get=Dimensions.get('window'),WINDOW_WIDTH=_Dimensions$get.width,WINDOW_HEIGHT=_Dimensions$get.height;var IS_IPHONE_X=Platform.OS==='ios'&&!Platform.isPad&&!Platform.isTVOS&&(WINDOW_HEIGHT===812||WINDOW_WIDTH===812);var EaseInOut=Easing.inOut(Easing.ease);var HEADER_LAYOUT_PRESET_VALUES=['center','left'];var HEADER_TRANSITION_PRESET_VALUES=['uikit','fade-in-place'];var ANIMATION_DURATION=500;var POSITION_THRESHOLD=1/2;var RESPOND_THRESHOLD=20;var GESTURE_RESPONSE_DISTANCE_HORIZONTAL=25;var GESTURE_RESPONSE_DISTANCE_VERTICAL=135;var animatedSubscribeValue=function animatedSubscribeValue(animatedValue){if(!animatedValue.__isNative){return;}if(Object.keys(animatedValue._listeners).length===0){animatedValue.addListener(emptyFunction);}};var getDefaultHeaderHeight=function getDefaultHeaderHeight(isLandscape){if(Platform.OS==='ios'){if(isLandscape&&!Platform.isPad){return 32;}else if(IS_IPHONE_X){return 88;}else{return 64;}}else{return 56;}};var StackViewLayout=function(_React$Component){_inherits(StackViewLayout,_React$Component);var _super=_createSuper(StackViewLayout);function StackViewLayout(props){var _this;_classCallCheck(this,StackViewLayout);_this=_super.call(this,props);_this._gestureStartValue=0;_this._isResponding=false;_this._immediateIndex=null;_this._panResponder=PanResponder.create({onPanResponderTerminate:function onPanResponderTerminate(){var navigation=_this.props.transitionProps.navigation;var index=navigation.state.index;_this._isResponding=false;_this._reset(index,0);_this.props.onGestureCanceled&&_this.props.onGestureCanceled();},onPanResponderGrant:function onPanResponderGrant(){var _this$props$transitio=_this.props.transitionProps,navigation=_this$props$transitio.navigation,position=_this$props$transitio.position,scene=_this$props$transitio.scene;var index=navigation.state.index;if(index!==scene.index){return false;}position.stopAnimation(function(value){_this._isResponding=true;_this._gestureStartValue=value;});_this.props.onGestureBegin&&_this.props.onGestureBegin();},onMoveShouldSetPanResponder:function onMoveShouldSetPanResponder(event,gesture){var _this$props=_this.props,_this$props$transitio2=_this$props.transitionProps,navigation=_this$props$transitio2.navigation,layout=_this$props$transitio2.layout,scene=_this$props$transitio2.scene,mode=_this$props.mode;var index=navigation.state.index;var isVertical=mode==='modal';var options=scene.descriptor.options;var gestureDirection=options.gestureDirection;var gestureDirectionInverted=typeof gestureDirection==='string'?gestureDirection==='inverted':I18nManager.isRTL;if(index!==scene.index){return false;}var immediateIndex=_this._immediateIndex==null?index:_this._immediateIndex;var currentDragDistance=gesture[isVertical?'dy':'dx'];var currentDragPosition=event.nativeEvent[isVertical?'pageY':'pageX'];var axisLength=isVertical?layout.height.__getValue():layout.width.__getValue();var axisHasBeenMeasured=!!axisLength;var screenEdgeDistance=gestureDirectionInverted?axisLength-(currentDragPosition-currentDragDistance):currentDragPosition-currentDragDistance;var _options$gestureRespo=options.gestureResponseDistance,userGestureResponseDistance=_options$gestureRespo===void 0?{}:_options$gestureRespo;var gestureResponseDistance=isVertical?userGestureResponseDistance.vertical||GESTURE_RESPONSE_DISTANCE_VERTICAL:userGestureResponseDistance.horizontal||GESTURE_RESPONSE_DISTANCE_HORIZONTAL;if(screenEdgeDistance>gestureResponseDistance){return false;}var hasDraggedEnough=Math.abs(currentDragDistance)>RESPOND_THRESHOLD;var isOnFirstCard=immediateIndex===0;var shouldSetResponder=hasDraggedEnough&&axisHasBeenMeasured&&!isOnFirstCard;return shouldSetResponder;},onPanResponderMove:function onPanResponderMove(event,gesture){var _this$props2=_this.props,_this$props2$transiti=_this$props2.transitionProps,navigation=_this$props2$transiti.navigation,position=_this$props2$transiti.position,layout=_this$props2$transiti.layout,scene=_this$props2$transiti.scene,mode=_this$props2.mode;var index=navigation.state.index;var isVertical=mode==='modal';var options=scene.descriptor.options;var gestureDirection=options.gestureDirection;var gestureDirectionInverted=typeof gestureDirection==='string'?gestureDirection==='inverted':I18nManager.isRTL;var startValue=_this._gestureStartValue;var axis=isVertical?'dy':'dx';var axisDistance=isVertical?layout.height.__getValue():layout.width.__getValue();var currentValue=axis==='dx'&&gestureDirectionInverted?startValue+gesture[axis]/axisDistance:startValue-gesture[axis]/axisDistance;var value=clamp(index-1,currentValue,index);position.setValue(value);},onPanResponderTerminationRequest:function onPanResponderTerminationRequest(){return false;},onPanResponderRelease:function onPanResponderRelease(event,gesture){var _this$props3=_this.props,_this$props3$transiti=_this$props3.transitionProps,navigation=_this$props3$transiti.navigation,position=_this$props3$transiti.position,layout=_this$props3$transiti.layout,scene=_this$props3$transiti.scene,mode=_this$props3.mode;var index=navigation.state.index;var isVertical=mode==='modal';var options=scene.descriptor.options;var gestureDirection=options.gestureDirection;var gestureDirectionInverted=typeof gestureDirection==='string'?gestureDirection==='inverted':I18nManager.isRTL;if(!_this._isResponding){return;}_this._isResponding=false;var immediateIndex=_this._immediateIndex==null?index:_this._immediateIndex;var axisDistance=isVertical?layout.height.__getValue():layout.width.__getValue();var movementDirection=gestureDirectionInverted?-1:1;var movedDistance=movementDirection*gesture[isVertical?'dy':'dx'];var gestureVelocity=movementDirection*gesture[isVertical?'vy':'vx'];var defaultVelocity=axisDistance/ANIMATION_DURATION;var velocity=Math.max(Math.abs(gestureVelocity),defaultVelocity);var resetDuration=gestureDirectionInverted?(axisDistance-movedDistance)/velocity:movedDistance/velocity;var goBackDuration=gestureDirectionInverted?movedDistance/velocity:(axisDistance-movedDistance)/velocity;position.stopAnimation(function(value){if(gestureVelocity<-0.5){_this.props.onGestureCanceled&&_this.props.onGestureCanceled();_this._reset(immediateIndex,resetDuration);return;}if(gestureVelocity>0.5){_this.props.onGestureFinish&&_this.props.onGestureFinish();_this._goBack(immediateIndex,goBackDuration);return;}if(value<=index-POSITION_THRESHOLD){_this.props.onGestureFinish&&_this.props.onGestureFinish();_this._goBack(immediateIndex,goBackDuration);}else{_this.props.onGestureCanceled&&_this.props.onGestureCanceled();_this._reset(immediateIndex,resetDuration);}});}});_this._onFloatingHeaderLayout=function(e){_this.setState({floatingHeaderHeight:e.nativeEvent.layout.height});};_this._getTransitionConfig=function(){var isModal=_this.props.mode==='modal';return TransitionConfigs.getTransitionConfig(_this.props.transitionConfig,_this.props.transitionProps,_this.props.lastTransitionProps,isModal);};_this._renderCard=function(scene){var _this$_getTransitionC=_this._getTransitionConfig(),screenInterpolator=_this$_getTransitionC.screenInterpolator;var style=screenInterpolator&&screenInterpolator(_objectSpread(_objectSpread({},_this.props.transitionProps),{},{scene:scene}));var options=scene.descriptor.options;var hasHeader=options.header!==null;var headerMode=_this._getHeaderMode();var marginTop=0;if(!hasHeader&&headerMode==='float'){marginTop=-_this.state.floatingHeaderHeight;}return React.createElement(Card,_extends({},_this.props.transitionProps,{key:\"card_\"+scene.key,style:[style,{marginTop:marginTop},_this.props.cardStyle],scene:scene}),_this._renderInnerScene(scene));};_this.state={floatingHeaderHeight:getDefaultHeaderHeight(props.isLandscape)};return _this;}_createClass(StackViewLayout,[{key:\"_renderHeader\",value:function _renderHeader(scene,headerMode){var options=scene.descriptor.options;var header=options.header;if(__DEV__&&typeof header==='string'){throw new Error(\"Invalid header value: \\\"\"+header+\"\\\". The header option must be a valid React component or null, not a string.\");}if(header===null&&headerMode==='screen'){return null;}if(React.isValidElement(header)){return header;}var renderHeader=header||function(props){return React.createElement(Header,props);};var _this$_getTransitionC2=this._getTransitionConfig(),headerLeftInterpolator=_this$_getTransitionC2.headerLeftInterpolator,headerTitleInterpolator=_this$_getTransitionC2.headerTitleInterpolator,headerRightInterpolator=_this$_getTransitionC2.headerRightInterpolator,headerBackgroundInterpolator=_this$_getTransitionC2.headerBackgroundInterpolator;var _this$props4=this.props,transitionProps=_this$props4.transitionProps,passProps=_objectWithoutProperties(_this$props4,[\"transitionProps\"]);return React.createElement(NavigationProvider,{value:scene.descriptor.navigation},renderHeader(_objectSpread(_objectSpread(_objectSpread({},passProps),transitionProps),{},{scene:scene,mode:headerMode,transitionPreset:this._getHeaderTransitionPreset(),layoutPreset:this._getHeaderLayoutPreset(),backTitleVisible:this._getheaderBackTitleVisible(),leftInterpolator:headerLeftInterpolator,titleInterpolator:headerTitleInterpolator,rightInterpolator:headerRightInterpolator,backgroundInterpolator:headerBackgroundInterpolator})));}},{key:\"_animatedSubscribe\",value:function _animatedSubscribe(props){animatedSubscribeValue(props.transitionProps.layout.width);animatedSubscribeValue(props.transitionProps.layout.height);animatedSubscribeValue(props.transitionProps.position);}},{key:\"_reset\",value:function _reset(resetToIndex,duration){if(Platform.OS==='ios'&&supportsImprovedSpringAnimation()){Animated.spring(this.props.transitionProps.position,{toValue:resetToIndex,stiffness:5000,damping:600,mass:3,useNativeDriver:this.props.transitionProps.position.__isNative}).start();}else{Animated.timing(this.props.transitionProps.position,{toValue:resetToIndex,duration:duration,easing:EaseInOut,useNativeDriver:this.props.transitionProps.position.__isNative}).start();}}},{key:\"_goBack\",value:function _goBack(backFromIndex,duration){var _this2=this;var _this$props$transitio3=this.props.transitionProps,navigation=_this$props$transitio3.navigation,position=_this$props$transitio3.position,scenes=_this$props$transitio3.scenes;var toValue=Math.max(backFromIndex-1,0);this._immediateIndex=toValue;var onCompleteAnimation=function onCompleteAnimation(){_this2._immediateIndex=null;var backFromScene=scenes.find(function(s){return s.index===toValue+1;});if(!_this2._isResponding&&backFromScene){navigation.dispatch(NavigationActions.back({key:backFromScene.route.key,immediate:true}));navigation.dispatch(StackActions.completeTransition());}};if(Platform.OS==='ios'&&supportsImprovedSpringAnimation()){Animated.spring(position,{toValue:toValue,stiffness:5000,damping:600,mass:3,useNativeDriver:position.__isNative}).start(onCompleteAnimation);}else{Animated.timing(position,{toValue:toValue,duration:duration,easing:EaseInOut,useNativeDriver:position.__isNative}).start(onCompleteAnimation);}}},{key:\"render\",value:function render(){var _this3=this;var floatingHeader=null;var headerMode=this._getHeaderMode();if(headerMode==='float'){var _scene=this.props.transitionProps.scene;floatingHeader=React.createElement(View,{pointerEvents:\"box-none\",onLayout:this._onFloatingHeaderLayout},this._renderHeader(_scene,headerMode));}var _this$props$transitio4=this.props.transitionProps,scene=_this$props$transitio4.scene,scenes=_this$props$transitio4.scenes;var options=scene.descriptor.options;var gesturesEnabled=typeof options.gesturesEnabled==='boolean'?options.gesturesEnabled:Platform.OS==='ios';var responder=!gesturesEnabled?null:this._panResponder;var handlers=gesturesEnabled?responder.panHandlers:{};var containerStyle=[styles.container,this._getTransitionConfig().containerStyle];return React.createElement(View,_extends({},handlers,{style:containerStyle}),React.createElement(ScreenContainer,{style:styles.scenes},scenes.map(function(s){return _this3._renderCard(s);})),floatingHeader);}},{key:\"_getHeaderMode\",value:function _getHeaderMode(){if(this.props.headerMode){return this.props.headerMode;}if(Platform.OS==='android'||this.props.mode==='modal'){return'screen';}return'float';}},{key:\"_getHeaderLayoutPreset\",value:function _getHeaderLayoutPreset(){var headerLayoutPreset=this.props.headerLayoutPreset;if(headerLayoutPreset){if(__DEV__){if(this._getHeaderTransitionPreset()==='uikit'&&headerLayoutPreset==='left'&&Platform.OS==='ios'){console.warn(\"headerTransitionPreset with the value 'ui-kit' is incompatible with headerLayoutPreset 'left'\");}}if(HEADER_LAYOUT_PRESET_VALUES.includes(headerLayoutPreset)){return headerLayoutPreset;}if(__DEV__){console.error(\"Invalid configuration applied for headerLayoutPreset - expected one of \"+HEADER_LAYOUT_PRESET_VALUES.join(', ')+\" but received \"+JSON.stringify(headerLayoutPreset));}}if(Platform.OS==='android'){return'left';}else{return'center';}}},{key:\"_getHeaderTransitionPreset\",value:function _getHeaderTransitionPreset(){if(Platform.OS==='android'||this._getHeaderMode()==='screen'){return'fade-in-place';}var headerTransitionPreset=this.props.headerTransitionPreset;if(headerTransitionPreset){if(HEADER_TRANSITION_PRESET_VALUES.includes(headerTransitionPreset)){return headerTransitionPreset;}if(__DEV__){console.error(\"Invalid configuration applied for headerTransitionPreset - expected one of \"+HEADER_TRANSITION_PRESET_VALUES.join(', ')+\" but received \"+JSON.stringify(headerTransitionPreset));}}return'fade-in-place';}},{key:\"_getheaderBackTitleVisible\",value:function _getheaderBackTitleVisible(){var headerBackTitleVisible=this.props.headerBackTitleVisible;return headerBackTitleVisible;}},{key:\"_renderInnerScene\",value:function _renderInnerScene(scene){var _scene$descriptor=scene.descriptor,navigation=_scene$descriptor.navigation,getComponent=_scene$descriptor.getComponent;var SceneComponent=getComponent();var screenProps=this.props.screenProps;var headerMode=this._getHeaderMode();if(headerMode==='screen'){return React.createElement(View,{style:styles.container},React.createElement(View,{style:styles.scenes},React.createElement(SceneView,{screenProps:screenProps,navigation:navigation,component:SceneComponent})),this._renderHeader(scene,headerMode));}return React.createElement(SceneView,{screenProps:screenProps,navigation:navigation,component:SceneComponent});}}]);return StackViewLayout;}(React.Component);var styles=StyleSheet.create({container:{flex:1,flexDirection:'column-reverse'},scenes:{flex:1}});export default withOrientation(StackViewLayout);","map":{"version":3,"sources":["E:/photofeed/node_modules/react-navigation-stack/dist/views/StackView/StackViewLayout.js"],"names":["React","clamp","SceneView","StackActions","NavigationActions","withOrientation","NavigationProvider","Card","Header","ScreenContainer","TransitionConfigs","supportsImprovedSpringAnimation","emptyFunction","Dimensions","get","WINDOW_WIDTH","width","WINDOW_HEIGHT","height","IS_IPHONE_X","Platform","OS","isPad","isTVOS","EaseInOut","Easing","inOut","ease","HEADER_LAYOUT_PRESET_VALUES","HEADER_TRANSITION_PRESET_VALUES","ANIMATION_DURATION","POSITION_THRESHOLD","RESPOND_THRESHOLD","GESTURE_RESPONSE_DISTANCE_HORIZONTAL","GESTURE_RESPONSE_DISTANCE_VERTICAL","animatedSubscribeValue","animatedValue","__isNative","Object","keys","_listeners","length","addListener","getDefaultHeaderHeight","isLandscape","StackViewLayout","props","_gestureStartValue","_isResponding","_immediateIndex","_panResponder","PanResponder","create","onPanResponderTerminate","navigation","transitionProps","index","state","_reset","onGestureCanceled","onPanResponderGrant","position","scene","stopAnimation","value","onGestureBegin","onMoveShouldSetPanResponder","event","gesture","layout","mode","isVertical","options","descriptor","gestureDirection","gestureDirectionInverted","I18nManager","isRTL","immediateIndex","currentDragDistance","currentDragPosition","nativeEvent","axisLength","__getValue","axisHasBeenMeasured","screenEdgeDistance","gestureResponseDistance","userGestureResponseDistance","vertical","horizontal","hasDraggedEnough","Math","abs","isOnFirstCard","shouldSetResponder","onPanResponderMove","startValue","axis","axisDistance","currentValue","setValue","onPanResponderTerminationRequest","onPanResponderRelease","movementDirection","movedDistance","gestureVelocity","defaultVelocity","velocity","max","resetDuration","goBackDuration","onGestureFinish","_goBack","_onFloatingHeaderLayout","e","setState","floatingHeaderHeight","_getTransitionConfig","isModal","getTransitionConfig","transitionConfig","lastTransitionProps","_renderCard","screenInterpolator","style","hasHeader","header","headerMode","_getHeaderMode","marginTop","key","cardStyle","_renderInnerScene","__DEV__","Error","isValidElement","renderHeader","headerLeftInterpolator","headerTitleInterpolator","headerRightInterpolator","headerBackgroundInterpolator","passProps","transitionPreset","_getHeaderTransitionPreset","layoutPreset","_getHeaderLayoutPreset","backTitleVisible","_getheaderBackTitleVisible","leftInterpolator","titleInterpolator","rightInterpolator","backgroundInterpolator","resetToIndex","duration","Animated","spring","toValue","stiffness","damping","mass","useNativeDriver","start","timing","easing","backFromIndex","scenes","onCompleteAnimation","backFromScene","find","s","dispatch","back","route","immediate","completeTransition","floatingHeader","_renderHeader","gesturesEnabled","responder","handlers","panHandlers","containerStyle","styles","container","map","headerLayoutPreset","console","warn","includes","error","join","JSON","stringify","headerTransitionPreset","headerBackTitleVisible","getComponent","SceneComponent","screenProps","Component","StyleSheet","flex","flexDirection"],"mappings":"y+DAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CAEA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,C,kfAEA,OAASC,SAAT,CAAoBC,YAApB,CAAkCC,iBAAlC,CAAqDC,eAArD,CAAsEC,kBAAtE,KAAgG,kBAAhG,CAEA,MAAOC,CAAAA,IAAP,uBACA,MAAOC,CAAAA,MAAP,wBACA,OAASC,eAAT,iBAEA,MAAOC,CAAAA,iBAAP,oCACA,OAASC,+BAAT,uCAEA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAAE,CAA9B,C,oBAEuDC,UAAU,CAACC,GAAX,CAAe,QAAf,C,CAAxCC,Y,iBAAPC,K,CAA6BC,a,iBAARC,M,CAC7B,GAAMC,CAAAA,WAAW,CAAGC,QAAQ,CAACC,EAAT,GAAgB,KAAhB,EAAyB,CAACD,QAAQ,CAACE,KAAnC,EAA4C,CAACF,QAAQ,CAACG,MAAtD,GAAiEN,aAAa,GAAK,GAAlB,EAAyBF,YAAY,GAAK,GAA3G,CAApB,CAEA,GAAMS,CAAAA,SAAS,CAAGC,MAAM,CAACC,KAAP,CAAaD,MAAM,CAACE,IAApB,CAAlB,CAKA,GAAMC,CAAAA,2BAA2B,CAAG,CAAC,QAAD,CAAW,MAAX,CAApC,CACA,GAAMC,CAAAA,+BAA+B,CAAG,CAAC,OAAD,CAAU,eAAV,CAAxC,CAOA,GAAMC,CAAAA,kBAAkB,CAAG,GAA3B,CAOA,GAAMC,CAAAA,kBAAkB,CAAG,EAAI,CAA/B,CAKA,GAAMC,CAAAA,iBAAiB,CAAG,EAA1B,CAKA,GAAMC,CAAAA,oCAAoC,CAAG,EAA7C,CACA,GAAMC,CAAAA,kCAAkC,CAAG,GAA3C,CAEA,GAAMC,CAAAA,sBAAsB,CAAG,QAAzBA,CAAAA,sBAAyB,CAAAC,aAAa,CAAI,CAC9C,GAAI,CAACA,aAAa,CAACC,UAAnB,CAA+B,CAC7B,OACD,CACD,GAAIC,MAAM,CAACC,IAAP,CAAYH,aAAa,CAACI,UAA1B,EAAsCC,MAAtC,GAAiD,CAArD,CAAwD,CACtDL,aAAa,CAACM,WAAd,CAA0B9B,aAA1B,EACD,CACF,CAPD,CASA,GAAM+B,CAAAA,sBAAsB,CAAG,QAAzBA,CAAAA,sBAAyB,CAAAC,WAAW,CAAI,CAC5C,GAAIxB,QAAQ,CAACC,EAAT,GAAgB,KAApB,CAA2B,CACzB,GAAIuB,WAAW,EAAI,CAACxB,QAAQ,CAACE,KAA7B,CAAoC,CAClC,MAAO,GAAP,CACD,CAFD,IAEO,IAAIH,WAAJ,CAAiB,CACtB,MAAO,GAAP,CACD,CAFM,IAEA,CACL,MAAO,GAAP,CACD,CACF,CARD,IAQO,CACL,MAAO,GAAP,CACD,CACF,CAZD,C,GAcM0B,CAAAA,e,iHAqBJ,yBAAYC,KAAZ,CAAmB,iDACjB,uBAAMA,KAAN,EADiB,MAdnBC,kBAcmB,CAdE,CAcF,OAXnBC,aAWmB,CAXH,KAWG,OAFnBC,eAEmB,CAFD,IAEC,OAiInBC,aAjImB,CAiIHC,YAAY,CAACC,MAAb,CAAoB,CAClCC,uBAAuB,CAAE,kCAAM,IACrBC,CAAAA,UADqB,CACN,MAAKR,KAAL,CAAWS,eADL,CACrBD,UADqB,IAErBE,CAAAA,KAFqB,CAEXF,UAAU,CAACG,KAFA,CAErBD,KAFqB,CAG7B,MAAKR,aAAL,CAAqB,KAArB,CACA,MAAKU,MAAL,CAAYF,KAAZ,CAAmB,CAAnB,EACA,MAAKV,KAAL,CAAWa,iBAAX,EAAgC,MAAKb,KAAL,CAAWa,iBAAX,EAAhC,CACD,CAPiC,CAQlCC,mBAAmB,CAAE,8BAAM,2BAGrB,MAAKd,KAHgB,CAEvBS,eAFuB,CAEJD,UAFI,uBAEJA,UAFI,CAEQO,QAFR,uBAEQA,QAFR,CAEkBC,KAFlB,uBAEkBA,KAFlB,IAIjBN,CAAAA,KAJiB,CAIPF,UAAU,CAACG,KAJJ,CAIjBD,KAJiB,CAMzB,GAAIA,KAAK,GAAKM,KAAK,CAACN,KAApB,CAA2B,CACzB,MAAO,MAAP,CACD,CAEDK,QAAQ,CAACE,aAAT,CAAuB,SAAAC,KAAK,CAAI,CAC9B,MAAKhB,aAAL,CAAqB,IAArB,CACA,MAAKD,kBAAL,CAA0BiB,KAA1B,CACD,CAHD,EAIA,MAAKlB,KAAL,CAAWmB,cAAX,EAA6B,MAAKnB,KAAL,CAAWmB,cAAX,EAA7B,CACD,CAvBiC,CAwBlCC,2BAA2B,CAAE,qCAACC,KAAD,CAAQC,OAAR,CAAoB,iBAI3C,MAAKtB,KAJsC,oCAE7CS,eAF6C,CAE1BD,UAF0B,wBAE1BA,UAF0B,CAEde,MAFc,wBAEdA,MAFc,CAENP,KAFM,wBAENA,KAFM,CAG7CQ,IAH6C,aAG7CA,IAH6C,IAKvCd,CAAAA,KALuC,CAK7BF,UAAU,CAACG,KALkB,CAKvCD,KALuC,CAM/C,GAAMe,CAAAA,UAAU,CAAGD,IAAI,GAAK,OAA5B,CAN+C,GAOvCE,CAAAA,OAPuC,CAO3BV,KAAK,CAACW,UAPqB,CAOvCD,OAPuC,CAQ/C,GAAME,CAAAA,gBAAgB,CAAGF,OAAO,CAACE,gBAAjC,CAEA,GAAMC,CAAAA,wBAAwB,CAAG,MAAOD,CAAAA,gBAAP,GAA4B,QAA5B,CAAuCA,gBAAgB,GAAK,UAA5D,CAAyEE,WAAW,CAACC,KAAtH,CAEA,GAAIrB,KAAK,GAAKM,KAAK,CAACN,KAApB,CAA2B,CACzB,MAAO,MAAP,CACD,CAED,GAAMsB,CAAAA,cAAc,CAAG,MAAK7B,eAAL,EAAwB,IAAxB,CAA+BO,KAA/B,CAAuC,MAAKP,eAAnE,CACA,GAAM8B,CAAAA,mBAAmB,CAAGX,OAAO,CAACG,UAAU,CAAG,IAAH,CAAU,IAArB,CAAnC,CACA,GAAMS,CAAAA,mBAAmB,CAAGb,KAAK,CAACc,WAAN,CAAkBV,UAAU,CAAG,OAAH,CAAa,OAAzC,CAA5B,CACA,GAAMW,CAAAA,UAAU,CAAGX,UAAU,CAAGF,MAAM,CAACnD,MAAP,CAAciE,UAAd,EAAH,CAAgCd,MAAM,CAACrD,KAAP,CAAamE,UAAb,EAA7D,CACA,GAAMC,CAAAA,mBAAmB,CAAG,CAAC,CAACF,UAA9B,CAGA,GAAMG,CAAAA,kBAAkB,CAAGV,wBAAwB,CAAGO,UAAU,EAAIF,mBAAmB,CAAGD,mBAA1B,CAAb,CAA8DC,mBAAmB,CAAGD,mBAAvI,CAvB+C,0BA4B3CP,OA5B2C,CA2B7Cc,uBA3B6C,CA2BpBC,2BA3BoB,gCA2BU,EA3BV,uBA6B/C,GAAMD,CAAAA,uBAAuB,CAAGf,UAAU,CAAGgB,2BAA2B,CAACC,QAA5B,EAAwCtD,kCAA3C,CAAgFqD,2BAA2B,CAACE,UAA5B,EAA0CxD,oCAApK,CAEA,GAAIoD,kBAAkB,CAAGC,uBAAzB,CAAkD,CAEhD,MAAO,MAAP,CACD,CAED,GAAMI,CAAAA,gBAAgB,CAAGC,IAAI,CAACC,GAAL,CAASb,mBAAT,EAAgC/C,iBAAzD,CAEA,GAAM6D,CAAAA,aAAa,CAAGf,cAAc,GAAK,CAAzC,CACA,GAAMgB,CAAAA,kBAAkB,CAAGJ,gBAAgB,EAAIN,mBAApB,EAA2C,CAACS,aAAvE,CACA,MAAOC,CAAAA,kBAAP,CACD,CAjEiC,CAkElCC,kBAAkB,CAAE,4BAAC5B,KAAD,CAAQC,OAAR,CAAoB,kBAIlC,MAAKtB,KAJ6B,oCAEpCS,eAFoC,CAEjBD,UAFiB,uBAEjBA,UAFiB,CAELO,QAFK,uBAELA,QAFK,CAEKQ,MAFL,uBAEKA,MAFL,CAEaP,KAFb,uBAEaA,KAFb,CAGpCQ,IAHoC,cAGpCA,IAHoC,IAK9Bd,CAAAA,KAL8B,CAKpBF,UAAU,CAACG,KALS,CAK9BD,KAL8B,CAMtC,GAAMe,CAAAA,UAAU,CAAGD,IAAI,GAAK,OAA5B,CANsC,GAO9BE,CAAAA,OAP8B,CAOlBV,KAAK,CAACW,UAPY,CAO9BD,OAP8B,CAQtC,GAAME,CAAAA,gBAAgB,CAAGF,OAAO,CAACE,gBAAjC,CAEA,GAAMC,CAAAA,wBAAwB,CAAG,MAAOD,CAAAA,gBAAP,GAA4B,QAA5B,CAAuCA,gBAAgB,GAAK,UAA5D,CAAyEE,WAAW,CAACC,KAAtH,CAGA,GAAMmB,CAAAA,UAAU,CAAG,MAAKjD,kBAAxB,CACA,GAAMkD,CAAAA,IAAI,CAAG1B,UAAU,CAAG,IAAH,CAAU,IAAjC,CACA,GAAM2B,CAAAA,YAAY,CAAG3B,UAAU,CAAGF,MAAM,CAACnD,MAAP,CAAciE,UAAd,EAAH,CAAgCd,MAAM,CAACrD,KAAP,CAAamE,UAAb,EAA/D,CACA,GAAMgB,CAAAA,YAAY,CAAGF,IAAI,GAAK,IAAT,EAAiBtB,wBAAjB,CAA4CqB,UAAU,CAAG5B,OAAO,CAAC6B,IAAD,CAAP,CAAgBC,YAAzE,CAAwFF,UAAU,CAAG5B,OAAO,CAAC6B,IAAD,CAAP,CAAgBC,YAA1I,CACA,GAAMlC,CAAAA,KAAK,CAAG/D,KAAK,CAACuD,KAAK,CAAG,CAAT,CAAY2C,YAAZ,CAA0B3C,KAA1B,CAAnB,CACAK,QAAQ,CAACuC,QAAT,CAAkBpC,KAAlB,EACD,CArFiC,CAsFlCqC,gCAAgC,CAAE,kDAGlC,MAHkC,EAtFA,CA0FlCC,qBAAqB,CAAE,+BAACnC,KAAD,CAAQC,OAAR,CAAoB,kBAIrC,MAAKtB,KAJgC,oCAEvCS,eAFuC,CAEpBD,UAFoB,uBAEpBA,UAFoB,CAERO,QAFQ,uBAERA,QAFQ,CAEEQ,MAFF,uBAEEA,MAFF,CAEUP,KAFV,uBAEUA,KAFV,CAGvCQ,IAHuC,cAGvCA,IAHuC,IAKjCd,CAAAA,KALiC,CAKvBF,UAAU,CAACG,KALY,CAKjCD,KALiC,CAMzC,GAAMe,CAAAA,UAAU,CAAGD,IAAI,GAAK,OAA5B,CANyC,GAOjCE,CAAAA,OAPiC,CAOrBV,KAAK,CAACW,UAPe,CAOjCD,OAPiC,CAQzC,GAAME,CAAAA,gBAAgB,CAAGF,OAAO,CAACE,gBAAjC,CAEA,GAAMC,CAAAA,wBAAwB,CAAG,MAAOD,CAAAA,gBAAP,GAA4B,QAA5B,CAAuCA,gBAAgB,GAAK,UAA5D,CAAyEE,WAAW,CAACC,KAAtH,CAEA,GAAI,CAAC,MAAK7B,aAAV,CAAyB,CACvB,OACD,CACD,MAAKA,aAAL,CAAqB,KAArB,CAEA,GAAM8B,CAAAA,cAAc,CAAG,MAAK7B,eAAL,EAAwB,IAAxB,CAA+BO,KAA/B,CAAuC,MAAKP,eAAnE,CAGA,GAAMiD,CAAAA,YAAY,CAAG3B,UAAU,CAAGF,MAAM,CAACnD,MAAP,CAAciE,UAAd,EAAH,CAAgCd,MAAM,CAACrD,KAAP,CAAamE,UAAb,EAA/D,CACA,GAAMoB,CAAAA,iBAAiB,CAAG5B,wBAAwB,CAAG,CAAC,CAAJ,CAAQ,CAA1D,CACA,GAAM6B,CAAAA,aAAa,CAAGD,iBAAiB,CAAGnC,OAAO,CAACG,UAAU,CAAG,IAAH,CAAU,IAArB,CAAjD,CACA,GAAMkC,CAAAA,eAAe,CAAGF,iBAAiB,CAAGnC,OAAO,CAACG,UAAU,CAAG,IAAH,CAAU,IAArB,CAAnD,CACA,GAAMmC,CAAAA,eAAe,CAAGR,YAAY,CAAGpE,kBAAvC,CACA,GAAM6E,CAAAA,QAAQ,CAAGhB,IAAI,CAACiB,GAAL,CAASjB,IAAI,CAACC,GAAL,CAASa,eAAT,CAAT,CAAoCC,eAApC,CAAjB,CACA,GAAMG,CAAAA,aAAa,CAAGlC,wBAAwB,CAAG,CAACuB,YAAY,CAAGM,aAAhB,EAAiCG,QAApC,CAA+CH,aAAa,CAAGG,QAA7G,CACA,GAAMG,CAAAA,cAAc,CAAGnC,wBAAwB,CAAG6B,aAAa,CAAGG,QAAnB,CAA8B,CAACT,YAAY,CAAGM,aAAhB,EAAiCG,QAA9G,CAGA9C,QAAQ,CAACE,aAAT,CAAuB,SAAAC,KAAK,CAAI,CAG9B,GAAIyC,eAAe,CAAG,CAAC,GAAvB,CAA4B,CAC1B,MAAK3D,KAAL,CAAWa,iBAAX,EAAgC,MAAKb,KAAL,CAAWa,iBAAX,EAAhC,CACA,MAAKD,MAAL,CAAYoB,cAAZ,CAA4B+B,aAA5B,EACA,OACD,CACD,GAAIJ,eAAe,CAAG,GAAtB,CAA2B,CACzB,MAAK3D,KAAL,CAAWiE,eAAX,EAA8B,MAAKjE,KAAL,CAAWiE,eAAX,EAA9B,CACA,MAAKC,OAAL,CAAalC,cAAb,CAA6BgC,cAA7B,EACA,OACD,CAID,GAAI9C,KAAK,EAAIR,KAAK,CAAGzB,kBAArB,CAAyC,CACvC,MAAKe,KAAL,CAAWiE,eAAX,EAA8B,MAAKjE,KAAL,CAAWiE,eAAX,EAA9B,CACA,MAAKC,OAAL,CAAalC,cAAb,CAA6BgC,cAA7B,EACD,CAHD,IAGO,CACL,MAAKhE,KAAL,CAAWa,iBAAX,EAAgC,MAAKb,KAAL,CAAWa,iBAAX,EAAhC,CACA,MAAKD,MAAL,CAAYoB,cAAZ,CAA4B+B,aAA5B,EACD,CACF,CAvBD,EAwBD,CAhJiC,CAApB,CAjIG,OAoRnBI,uBApRmB,CAoRO,SAAAC,CAAC,CAAI,CAC7B,MAAKC,QAAL,CAAc,CAAEC,oBAAoB,CAAEF,CAAC,CAACjC,WAAF,CAAcZ,MAAd,CAAqBnD,MAA7C,CAAd,EACD,CAtRkB,OAoYnBmG,oBApYmB,CAoYI,UAAM,CAC3B,GAAMC,CAAAA,OAAO,CAAG,MAAKxE,KAAL,CAAWwB,IAAX,GAAoB,OAApC,CAEA,MAAO5D,CAAAA,iBAAiB,CAAC6G,mBAAlB,CAAsC,MAAKzE,KAAL,CAAW0E,gBAAjD,CAAmE,MAAK1E,KAAL,CAAWS,eAA9E,CAA+F,MAAKT,KAAL,CAAW2E,mBAA1G,CAA+HH,OAA/H,CAAP,CACD,CAxYkB,OA0YnBI,WA1YmB,CA0YL,SAAA5D,KAAK,CAAI,2BACU,MAAKuD,oBAAL,EADV,CACbM,kBADa,uBACbA,kBADa,CAGrB,GAAMC,CAAAA,KAAK,CAAGD,kBAAkB,EAAIA,kBAAkB,gCAAM,MAAK7E,KAAL,CAAWS,eAAjB,MAAkCO,KAAK,CAALA,KAAlC,GAAtD,CAHqB,GAQbU,CAAAA,OARa,CAQDV,KAAK,CAACW,UARL,CAQbD,OARa,CASrB,GAAMqD,CAAAA,SAAS,CAAGrD,OAAO,CAACsD,MAAR,GAAmB,IAArC,CACA,GAAMC,CAAAA,UAAU,CAAG,MAAKC,cAAL,EAAnB,CACA,GAAIC,CAAAA,SAAS,CAAG,CAAhB,CACA,GAAI,CAACJ,SAAD,EAAcE,UAAU,GAAK,OAAjC,CAA0C,CACxCE,SAAS,CAAG,CAAC,MAAKxE,KAAL,CAAW2D,oBAAxB,CACD,CAED,MAAO,qBAAC,IAAD,aAAU,MAAKtE,KAAL,CAAWS,eAArB,EAAsC,GAAG,SAAUO,KAAK,CAACoE,GAAzD,CAAgE,KAAK,CAAE,CAACN,KAAD,CAAQ,CAAEK,SAAS,CAATA,SAAF,CAAR,CAAuB,MAAKnF,KAAL,CAAWqF,SAAlC,CAAvE,CAAqH,KAAK,CAAErE,KAA5H,GACF,MAAKsE,iBAAL,CAAuBtE,KAAvB,CADE,CAAP,CAGD,CA7ZkB,CAGjB,MAAKL,KAAL,CAAa,CAMX2D,oBAAoB,CAAEzE,sBAAsB,CAACG,KAAK,CAACF,WAAP,CANjC,CAAb,CAHiB,aAWlB,C,gFAEakB,K,CAAOiE,U,CAAY,IACvBvD,CAAAA,OADuB,CACXV,KAAK,CAACW,UADK,CACvBD,OADuB,IAEvBsD,CAAAA,MAFuB,CAEZtD,OAFY,CAEvBsD,MAFuB,CAI/B,GAAIO,OAAO,EAAI,MAAOP,CAAAA,MAAP,GAAkB,QAAjC,CAA2C,CACzC,KAAM,IAAIQ,CAAAA,KAAJ,4BAAoCR,MAApC,gFAAN,CACD,CAED,GAAIA,MAAM,GAAK,IAAX,EAAmBC,UAAU,GAAK,QAAtC,CAAgD,CAC9C,MAAO,KAAP,CACD,CAGD,GAAI/H,KAAK,CAACuI,cAAN,CAAqBT,MAArB,CAAJ,CAAkC,CAChC,MAAOA,CAAAA,MAAP,CACD,CAGD,GAAMU,CAAAA,YAAY,CAAGV,MAAM,EAAK,SAAAhF,KAAK,QAAI,qBAAC,MAAD,CAAYA,KAAZ,CAAJ,EAArC,CAlB+B,2BAyB3B,KAAKuE,oBAAL,EAzB2B,CAqB7BoB,sBArB6B,wBAqB7BA,sBArB6B,CAsB7BC,uBAtB6B,wBAsB7BA,uBAtB6B,CAuB7BC,uBAvB6B,wBAuB7BA,uBAvB6B,CAwB7BC,4BAxB6B,wBAwB7BA,4BAxB6B,kBA2BW,KAAK9F,KA3BhB,CA2BvBS,eA3BuB,cA2BvBA,eA3BuB,CA2BHsF,SA3BG,4DA6B/B,MAAO,qBAAC,kBAAD,EAAoB,KAAK,CAAE/E,KAAK,CAACW,UAAN,CAAiBnB,UAA5C,EACFkF,YAAY,8CACVK,SADU,EAEVtF,eAFU,MAGbO,KAAK,CAALA,KAHa,CAIbQ,IAAI,CAAEyD,UAJO,CAKbe,gBAAgB,CAAE,KAAKC,0BAAL,EALL,CAMbC,YAAY,CAAE,KAAKC,sBAAL,EAND,CAObC,gBAAgB,CAAE,KAAKC,0BAAL,EAPL,CAQbC,gBAAgB,CAAEX,sBARL,CASbY,iBAAiB,CAAEX,uBATN,CAUbY,iBAAiB,CAAEX,uBAVN,CAWbY,sBAAsB,CAAEX,4BAXX,GADV,CAAP,CAeD,C,8DAEkB9F,K,CAAO,CAQxBX,sBAAsB,CAACW,KAAK,CAACS,eAAN,CAAsBc,MAAtB,CAA6BrD,KAA9B,CAAtB,CACAmB,sBAAsB,CAACW,KAAK,CAACS,eAAN,CAAsBc,MAAtB,CAA6BnD,MAA9B,CAAtB,CACAiB,sBAAsB,CAACW,KAAK,CAACS,eAAN,CAAsBM,QAAvB,CAAtB,CACD,C,sCAEM2F,Y,CAAcC,Q,CAAU,CAC7B,GAAIrI,QAAQ,CAACC,EAAT,GAAgB,KAAhB,EAAyBV,+BAA+B,EAA5D,CAAgE,CAC9D+I,QAAQ,CAACC,MAAT,CAAgB,KAAK7G,KAAL,CAAWS,eAAX,CAA2BM,QAA3C,CAAqD,CACnD+F,OAAO,CAAEJ,YAD0C,CAEnDK,SAAS,CAAE,IAFwC,CAGnDC,OAAO,CAAE,GAH0C,CAInDC,IAAI,CAAE,CAJ6C,CAKnDC,eAAe,CAAE,KAAKlH,KAAL,CAAWS,eAAX,CAA2BM,QAA3B,CAAoCxB,UALF,CAArD,EAMG4H,KANH,GAOD,CARD,IAQO,CACLP,QAAQ,CAACQ,MAAT,CAAgB,KAAKpH,KAAL,CAAWS,eAAX,CAA2BM,QAA3C,CAAqD,CACnD+F,OAAO,CAAEJ,YAD0C,CAEnDC,QAAQ,CAARA,QAFmD,CAGnDU,MAAM,CAAE3I,SAH2C,CAInDwI,eAAe,CAAE,KAAKlH,KAAL,CAAWS,eAAX,CAA2BM,QAA3B,CAAoCxB,UAJF,CAArD,EAKG4H,KALH,GAMD,CACF,C,wCAEOG,a,CAAeX,Q,CAAU,4CACU,KAAK3G,KAAL,CAAWS,eADrB,CACvBD,UADuB,wBACvBA,UADuB,CACXO,QADW,wBACXA,QADW,CACDwG,MADC,wBACDA,MADC,CAE/B,GAAMT,CAAAA,OAAO,CAAGjE,IAAI,CAACiB,GAAL,CAASwD,aAAa,CAAG,CAAzB,CAA4B,CAA5B,CAAhB,CAIA,KAAKnH,eAAL,CAAuB2G,OAAvB,CAEA,GAAMU,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,EAAM,CAChC,MAAI,CAACrH,eAAL,CAAuB,IAAvB,CACA,GAAMsH,CAAAA,aAAa,CAAGF,MAAM,CAACG,IAAP,CAAY,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACjH,KAAF,GAAYoG,OAAO,CAAG,CAA1B,EAAb,CAAtB,CACA,GAAI,CAAC,MAAI,CAAC5G,aAAN,EAAuBuH,aAA3B,CAA0C,CACxCjH,UAAU,CAACoH,QAAX,CAAoBtK,iBAAiB,CAACuK,IAAlB,CAAuB,CACzCzC,GAAG,CAAEqC,aAAa,CAACK,KAAd,CAAoB1C,GADgB,CAEzC2C,SAAS,CAAE,IAF8B,CAAvB,CAApB,EAIAvH,UAAU,CAACoH,QAAX,CAAoBvK,YAAY,CAAC2K,kBAAb,EAApB,EACD,CACF,CAVD,CAYA,GAAI1J,QAAQ,CAACC,EAAT,GAAgB,KAAhB,EAAyBV,+BAA+B,EAA5D,CAAgE,CAC9D+I,QAAQ,CAACC,MAAT,CAAgB9F,QAAhB,CAA0B,CACxB+F,OAAO,CAAPA,OADwB,CAExBC,SAAS,CAAE,IAFa,CAGxBC,OAAO,CAAE,GAHe,CAIxBC,IAAI,CAAE,CAJkB,CAKxBC,eAAe,CAAEnG,QAAQ,CAACxB,UALF,CAA1B,EAMG4H,KANH,CAMSK,mBANT,EAOD,CARD,IAQO,CACLZ,QAAQ,CAACQ,MAAT,CAAgBrG,QAAhB,CAA0B,CACxB+F,OAAO,CAAPA,OADwB,CAExBH,QAAQ,CAARA,QAFwB,CAGxBU,MAAM,CAAE3I,SAHgB,CAIxBwI,eAAe,CAAEnG,QAAQ,CAACxB,UAJF,CAA1B,EAKG4H,KALH,CAKSK,mBALT,EAMD,CACF,C,uCAyJQ,iBACP,GAAIS,CAAAA,cAAc,CAAG,IAArB,CACA,GAAMhD,CAAAA,UAAU,CAAG,KAAKC,cAAL,EAAnB,CAEA,GAAID,UAAU,GAAK,OAAnB,CAA4B,IAClBjE,CAAAA,MADkB,CACR,KAAKhB,KAAL,CAAWS,eADH,CAClBO,KADkB,CAE1BiH,cAAc,CAAG,oBAAC,IAAD,EAAM,aAAa,CAAC,UAApB,CAA+B,QAAQ,CAAE,KAAK9D,uBAA9C,EACZ,KAAK+D,aAAL,CAAmBlH,MAAnB,CAA0BiE,UAA1B,CADY,CAAjB,CAGD,CATM,2BAYH,KAAKjF,KAZF,CAWLS,eAXK,CAWcO,KAXd,wBAWcA,KAXd,CAWqBuG,MAXrB,wBAWqBA,MAXrB,IAaC7F,CAAAA,OAbD,CAaaV,KAAK,CAACW,UAbnB,CAaCD,OAbD,CAeP,GAAMyG,CAAAA,eAAe,CAAG,MAAOzG,CAAAA,OAAO,CAACyG,eAAf,GAAmC,SAAnC,CAA+CzG,OAAO,CAACyG,eAAvD,CAAyE7J,QAAQ,CAACC,EAAT,GAAgB,KAAjH,CAEA,GAAM6J,CAAAA,SAAS,CAAG,CAACD,eAAD,CAAmB,IAAnB,CAA0B,KAAK/H,aAAjD,CAEA,GAAMiI,CAAAA,QAAQ,CAAGF,eAAe,CAAGC,SAAS,CAACE,WAAb,CAA2B,EAA3D,CACA,GAAMC,CAAAA,cAAc,CAAG,CAACC,MAAM,CAACC,SAAR,CAAmB,KAAKlE,oBAAL,GAA4BgE,cAA/C,CAAvB,CAEA,MAAO,qBAAC,IAAD,aAAUF,QAAV,EAAoB,KAAK,CAAEE,cAA3B,GACH,oBAAC,eAAD,EAAiB,KAAK,CAAEC,MAAM,CAACjB,MAA/B,EACGA,MAAM,CAACmB,GAAP,CAAW,SAAAf,CAAC,QAAI,CAAA,MAAI,CAAC/C,WAAL,CAAiB+C,CAAjB,CAAJ,EAAZ,CADH,CADG,CAIFM,cAJE,CAAP,CAMD,C,uDAEgB,CACf,GAAI,KAAKjI,KAAL,CAAWiF,UAAf,CAA2B,CACzB,MAAO,MAAKjF,KAAL,CAAWiF,UAAlB,CACD,CACD,GAAI3G,QAAQ,CAACC,EAAT,GAAgB,SAAhB,EAA6B,KAAKyB,KAAL,CAAWwB,IAAX,GAAoB,OAArD,CAA8D,CAC5D,MAAO,QAAP,CACD,CACD,MAAO,OAAP,CACD,C,uEAEwB,IACfmH,CAAAA,kBADe,CACQ,KAAK3I,KADb,CACf2I,kBADe,CAEvB,GAAIA,kBAAJ,CAAwB,CACtB,GAAIpD,OAAJ,CAAa,CACX,GAAI,KAAKU,0BAAL,KAAsC,OAAtC,EAAiD0C,kBAAkB,GAAK,MAAxE,EAAkFrK,QAAQ,CAACC,EAAT,GAAgB,KAAtG,CAA6G,CAC3GqK,OAAO,CAACC,IAAR,kGACD,CACF,CACD,GAAI/J,2BAA2B,CAACgK,QAA5B,CAAqCH,kBAArC,CAAJ,CAA8D,CAC5D,MAAOA,CAAAA,kBAAP,CACD,CAED,GAAIpD,OAAJ,CAAa,CACXqD,OAAO,CAACG,KAAR,2EAAwFjK,2BAA2B,CAACkK,IAA5B,CAAiC,IAAjC,CAAxF,kBAA+IC,IAAI,CAACC,SAAL,CAAeP,kBAAf,CAA/I,EACD,CACF,CAED,GAAIrK,QAAQ,CAACC,EAAT,GAAgB,SAApB,CAA+B,CAC7B,MAAO,MAAP,CACD,CAFD,IAEO,CACL,MAAO,QAAP,CACD,CACF,C,+EAE4B,CAG3B,GAAID,QAAQ,CAACC,EAAT,GAAgB,SAAhB,EAA6B,KAAK2G,cAAL,KAA0B,QAA3D,CAAqE,CACnE,MAAO,eAAP,CACD,CAL0B,GAOnBiE,CAAAA,sBAPmB,CAOQ,KAAKnJ,KAPb,CAOnBmJ,sBAPmB,CAQ3B,GAAIA,sBAAJ,CAA4B,CAC1B,GAAIpK,+BAA+B,CAAC+J,QAAhC,CAAyCK,sBAAzC,CAAJ,CAAsE,CACpE,MAAOA,CAAAA,sBAAP,CACD,CAED,GAAI5D,OAAJ,CAAa,CACXqD,OAAO,CAACG,KAAR,+EAA4FhK,+BAA+B,CAACiK,IAAhC,CAAqC,IAArC,CAA5F,kBAAuJC,IAAI,CAACC,SAAL,CAAeC,sBAAf,CAAvJ,EACD,CACF,CAED,MAAO,eAAP,CACD,C,+EAE4B,IACnBC,CAAAA,sBADmB,CACQ,KAAKpJ,KADb,CACnBoJ,sBADmB,CAG3B,MAAOA,CAAAA,sBAAP,CACD,C,4DAEiBpI,K,CAAO,uBACcA,KAAK,CAACW,UADpB,CACfnB,UADe,mBACfA,UADe,CACH6I,YADG,mBACHA,YADG,CAEvB,GAAMC,CAAAA,cAAc,CAAGD,YAAY,EAAnC,CAFuB,GAIfE,CAAAA,WAJe,CAIC,KAAKvJ,KAJN,CAIfuJ,WAJe,CAKvB,GAAMtE,CAAAA,UAAU,CAAG,KAAKC,cAAL,EAAnB,CACA,GAAID,UAAU,GAAK,QAAnB,CAA6B,CAC3B,MAAO,qBAAC,IAAD,EAAM,KAAK,CAAEuD,MAAM,CAACC,SAApB,EACH,oBAAC,IAAD,EAAM,KAAK,CAAED,MAAM,CAACjB,MAApB,EACE,oBAAC,SAAD,EAAW,WAAW,CAAEgC,WAAxB,CAAqC,UAAU,CAAE/I,UAAjD,CAA6D,SAAS,CAAE8I,cAAxE,EADF,CADG,CAIF,KAAKpB,aAAL,CAAmBlH,KAAnB,CAA0BiE,UAA1B,CAJE,CAAP,CAMD,CACD,MAAO,qBAAC,SAAD,EAAW,WAAW,CAAEsE,WAAxB,CAAqC,UAAU,CAAE/I,UAAjD,CAA6D,SAAS,CAAE8I,cAAxE,EAAP,CACD,C,6BAvZ2BpM,KAAK,CAACsM,S,EAqbpC,GAAMhB,CAAAA,MAAM,CAAGiB,UAAU,CAACnJ,MAAX,CAAkB,CAC/BmI,SAAS,CAAE,CACTiB,IAAI,CAAE,CADG,CAMTC,aAAa,CAAE,gBANN,CADoB,CAS/BpC,MAAM,CAAE,CACNmC,IAAI,CAAE,CADA,CATuB,CAAlB,CAAf,CAcA,cAAenM,CAAAA,eAAe,CAACwC,eAAD,CAA9B","sourcesContent":["import React from 'react';\n\nimport clamp from 'clamp';\nimport { Animated, StyleSheet, PanResponder, Platform, View, I18nManager, Easing, Dimensions } from 'react-native';\nimport { SceneView, StackActions, NavigationActions, withOrientation, NavigationProvider } from 'react-navigation';\n\nimport Card from './StackViewCard';\nimport Header from '../Header/Header';\nimport { ScreenContainer } from './screens';\n\nimport TransitionConfigs from './StackViewTransitionConfigs';\nimport { supportsImprovedSpringAnimation } from '../../utils/ReactNativeFeatures';\n\nconst emptyFunction = () => {};\n\nconst { width: WINDOW_WIDTH, height: WINDOW_HEIGHT } = Dimensions.get('window');\nconst IS_IPHONE_X = Platform.OS === 'ios' && !Platform.isPad && !Platform.isTVOS && (WINDOW_HEIGHT === 812 || WINDOW_WIDTH === 812);\n\nconst EaseInOut = Easing.inOut(Easing.ease);\n\n/**\n * Enumerate possible values for validation\n */\nconst HEADER_LAYOUT_PRESET_VALUES = ['center', 'left'];\nconst HEADER_TRANSITION_PRESET_VALUES = ['uikit', 'fade-in-place'];\n\n/**\n * The max duration of the card animation in milliseconds after released gesture.\n * The actual duration should be always less then that because the rest distance\n * is always less then the full distance of the layout.\n */\nconst ANIMATION_DURATION = 500;\n\n/**\n * The gesture distance threshold to trigger the back behavior. For instance,\n * `1/2` means that moving greater than 1/2 of the width of the screen will\n * trigger a back action\n */\nconst POSITION_THRESHOLD = 1 / 2;\n\n/**\n * The threshold (in pixels) to start the gesture action.\n */\nconst RESPOND_THRESHOLD = 20;\n\n/**\n * The distance of touch start from the edge of the screen where the gesture will be recognized\n */\nconst GESTURE_RESPONSE_DISTANCE_HORIZONTAL = 25;\nconst GESTURE_RESPONSE_DISTANCE_VERTICAL = 135;\n\nconst animatedSubscribeValue = animatedValue => {\n  if (!animatedValue.__isNative) {\n    return;\n  }\n  if (Object.keys(animatedValue._listeners).length === 0) {\n    animatedValue.addListener(emptyFunction);\n  }\n};\n\nconst getDefaultHeaderHeight = isLandscape => {\n  if (Platform.OS === 'ios') {\n    if (isLandscape && !Platform.isPad) {\n      return 32;\n    } else if (IS_IPHONE_X) {\n      return 88;\n    } else {\n      return 64;\n    }\n  } else {\n    return 56;\n  }\n};\n\nclass StackViewLayout extends React.Component {\n  /**\n   * Used to identify the starting point of the position when the gesture starts, such that it can\n   * be updated according to its relative position. This means that a card can effectively be\n   * \"caught\"- If a gesture starts while a card is animating, the card does not jump into a\n   * corresponding location for the touch.\n   */\n  _gestureStartValue = 0;\n\n  // tracks if a touch is currently happening\n  _isResponding = false;\n\n  /**\n   * immediateIndex is used to represent the expected index that we will be on after a\n   * transition. To achieve a smooth animation when swiping back, the action to go back\n   * doesn't actually fire until the transition completes. The immediateIndex is used during\n   * the transition so that gestures can be handled correctly. This is a work-around for\n   * cases when the user quickly swipes back several times.\n   */\n  _immediateIndex = null;\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      // Used when card's header is null and mode is float to make transition\n      // between screens with headers and those without headers smooth.\n      // This is not a great heuristic here. We don't know synchronously\n      // on mount what the header height is so we have just used the most\n      // common cases here.\n      floatingHeaderHeight: getDefaultHeaderHeight(props.isLandscape)\n    };\n  }\n\n  _renderHeader(scene, headerMode) {\n    const { options } = scene.descriptor;\n    const { header } = options;\n\n    if (__DEV__ && typeof header === 'string') {\n      throw new Error(`Invalid header value: \"${header}\". The header option must be a valid React component or null, not a string.`);\n    }\n\n    if (header === null && headerMode === 'screen') {\n      return null;\n    }\n\n    // check if it's a react element\n    if (React.isValidElement(header)) {\n      return header;\n    }\n\n    // Handle the case where the header option is a function, and provide the default\n    const renderHeader = header || (props => <Header {...props} />);\n\n    const {\n      headerLeftInterpolator,\n      headerTitleInterpolator,\n      headerRightInterpolator,\n      headerBackgroundInterpolator\n    } = this._getTransitionConfig();\n\n    const { transitionProps, ...passProps } = this.props;\n\n    return <NavigationProvider value={scene.descriptor.navigation}>\n        {renderHeader({\n        ...passProps,\n        ...transitionProps,\n        scene,\n        mode: headerMode,\n        transitionPreset: this._getHeaderTransitionPreset(),\n        layoutPreset: this._getHeaderLayoutPreset(),\n        backTitleVisible: this._getheaderBackTitleVisible(),\n        leftInterpolator: headerLeftInterpolator,\n        titleInterpolator: headerTitleInterpolator,\n        rightInterpolator: headerRightInterpolator,\n        backgroundInterpolator: headerBackgroundInterpolator\n      })}\n      </NavigationProvider>;\n  }\n\n  _animatedSubscribe(props) {\n    // Hack to make this work with native driven animations. We add a single listener\n    // so the JS value of the following animated values gets updated. We rely on\n    // some Animated private APIs and not doing so would require using a bunch of\n    // value listeners but we'd have to remove them to not leak and I'm not sure\n    // when we'd do that with the current structure we have. `stopAnimation` callback\n    // is also broken with native animated values that have no listeners so if we\n    // want to remove this we have to fix this too.\n    animatedSubscribeValue(props.transitionProps.layout.width);\n    animatedSubscribeValue(props.transitionProps.layout.height);\n    animatedSubscribeValue(props.transitionProps.position);\n  }\n\n  _reset(resetToIndex, duration) {\n    if (Platform.OS === 'ios' && supportsImprovedSpringAnimation()) {\n      Animated.spring(this.props.transitionProps.position, {\n        toValue: resetToIndex,\n        stiffness: 5000,\n        damping: 600,\n        mass: 3,\n        useNativeDriver: this.props.transitionProps.position.__isNative\n      }).start();\n    } else {\n      Animated.timing(this.props.transitionProps.position, {\n        toValue: resetToIndex,\n        duration,\n        easing: EaseInOut,\n        useNativeDriver: this.props.transitionProps.position.__isNative\n      }).start();\n    }\n  }\n\n  _goBack(backFromIndex, duration) {\n    const { navigation, position, scenes } = this.props.transitionProps;\n    const toValue = Math.max(backFromIndex - 1, 0);\n\n    // set temporary index for gesture handler to respect until the action is\n    // dispatched at the end of the transition.\n    this._immediateIndex = toValue;\n\n    const onCompleteAnimation = () => {\n      this._immediateIndex = null;\n      const backFromScene = scenes.find(s => s.index === toValue + 1);\n      if (!this._isResponding && backFromScene) {\n        navigation.dispatch(NavigationActions.back({\n          key: backFromScene.route.key,\n          immediate: true\n        }));\n        navigation.dispatch(StackActions.completeTransition());\n      }\n    };\n\n    if (Platform.OS === 'ios' && supportsImprovedSpringAnimation()) {\n      Animated.spring(position, {\n        toValue,\n        stiffness: 5000,\n        damping: 600,\n        mass: 3,\n        useNativeDriver: position.__isNative\n      }).start(onCompleteAnimation);\n    } else {\n      Animated.timing(position, {\n        toValue,\n        duration,\n        easing: EaseInOut,\n        useNativeDriver: position.__isNative\n      }).start(onCompleteAnimation);\n    }\n  }\n\n  _panResponder = PanResponder.create({\n    onPanResponderTerminate: () => {\n      const { navigation } = this.props.transitionProps;\n      const { index } = navigation.state;\n      this._isResponding = false;\n      this._reset(index, 0);\n      this.props.onGestureCanceled && this.props.onGestureCanceled();\n    },\n    onPanResponderGrant: () => {\n      const {\n        transitionProps: { navigation, position, scene }\n      } = this.props;\n      const { index } = navigation.state;\n\n      if (index !== scene.index) {\n        return false;\n      }\n\n      position.stopAnimation(value => {\n        this._isResponding = true;\n        this._gestureStartValue = value;\n      });\n      this.props.onGestureBegin && this.props.onGestureBegin();\n    },\n    onMoveShouldSetPanResponder: (event, gesture) => {\n      const {\n        transitionProps: { navigation, layout, scene },\n        mode\n      } = this.props;\n      const { index } = navigation.state;\n      const isVertical = mode === 'modal';\n      const { options } = scene.descriptor;\n      const gestureDirection = options.gestureDirection;\n\n      const gestureDirectionInverted = typeof gestureDirection === 'string' ? gestureDirection === 'inverted' : I18nManager.isRTL;\n\n      if (index !== scene.index) {\n        return false;\n      }\n\n      const immediateIndex = this._immediateIndex == null ? index : this._immediateIndex;\n      const currentDragDistance = gesture[isVertical ? 'dy' : 'dx'];\n      const currentDragPosition = event.nativeEvent[isVertical ? 'pageY' : 'pageX'];\n      const axisLength = isVertical ? layout.height.__getValue() : layout.width.__getValue();\n      const axisHasBeenMeasured = !!axisLength;\n\n      // Measure the distance from the touch to the edge of the screen\n      const screenEdgeDistance = gestureDirectionInverted ? axisLength - (currentDragPosition - currentDragDistance) : currentDragPosition - currentDragDistance;\n      // Compare to the gesture distance relavant to card or modal\n\n      const {\n        gestureResponseDistance: userGestureResponseDistance = {}\n      } = options;\n      const gestureResponseDistance = isVertical ? userGestureResponseDistance.vertical || GESTURE_RESPONSE_DISTANCE_VERTICAL : userGestureResponseDistance.horizontal || GESTURE_RESPONSE_DISTANCE_HORIZONTAL;\n      // GESTURE_RESPONSE_DISTANCE is about 25 or 30. Or 135 for modals\n      if (screenEdgeDistance > gestureResponseDistance) {\n        // Reject touches that started in the middle of the screen\n        return false;\n      }\n\n      const hasDraggedEnough = Math.abs(currentDragDistance) > RESPOND_THRESHOLD;\n\n      const isOnFirstCard = immediateIndex === 0;\n      const shouldSetResponder = hasDraggedEnough && axisHasBeenMeasured && !isOnFirstCard;\n      return shouldSetResponder;\n    },\n    onPanResponderMove: (event, gesture) => {\n      const {\n        transitionProps: { navigation, position, layout, scene },\n        mode\n      } = this.props;\n      const { index } = navigation.state;\n      const isVertical = mode === 'modal';\n      const { options } = scene.descriptor;\n      const gestureDirection = options.gestureDirection;\n\n      const gestureDirectionInverted = typeof gestureDirection === 'string' ? gestureDirection === 'inverted' : I18nManager.isRTL;\n\n      // Handle the moving touches for our granted responder\n      const startValue = this._gestureStartValue;\n      const axis = isVertical ? 'dy' : 'dx';\n      const axisDistance = isVertical ? layout.height.__getValue() : layout.width.__getValue();\n      const currentValue = axis === 'dx' && gestureDirectionInverted ? startValue + gesture[axis] / axisDistance : startValue - gesture[axis] / axisDistance;\n      const value = clamp(index - 1, currentValue, index);\n      position.setValue(value);\n    },\n    onPanResponderTerminationRequest: () =>\n    // Returning false will prevent other views from becoming responder while\n    // the navigation view is the responder (mid-gesture)\n    false,\n    onPanResponderRelease: (event, gesture) => {\n      const {\n        transitionProps: { navigation, position, layout, scene },\n        mode\n      } = this.props;\n      const { index } = navigation.state;\n      const isVertical = mode === 'modal';\n      const { options } = scene.descriptor;\n      const gestureDirection = options.gestureDirection;\n\n      const gestureDirectionInverted = typeof gestureDirection === 'string' ? gestureDirection === 'inverted' : I18nManager.isRTL;\n\n      if (!this._isResponding) {\n        return;\n      }\n      this._isResponding = false;\n\n      const immediateIndex = this._immediateIndex == null ? index : this._immediateIndex;\n\n      // Calculate animate duration according to gesture speed and moved distance\n      const axisDistance = isVertical ? layout.height.__getValue() : layout.width.__getValue();\n      const movementDirection = gestureDirectionInverted ? -1 : 1;\n      const movedDistance = movementDirection * gesture[isVertical ? 'dy' : 'dx'];\n      const gestureVelocity = movementDirection * gesture[isVertical ? 'vy' : 'vx'];\n      const defaultVelocity = axisDistance / ANIMATION_DURATION;\n      const velocity = Math.max(Math.abs(gestureVelocity), defaultVelocity);\n      const resetDuration = gestureDirectionInverted ? (axisDistance - movedDistance) / velocity : movedDistance / velocity;\n      const goBackDuration = gestureDirectionInverted ? movedDistance / velocity : (axisDistance - movedDistance) / velocity;\n\n      // To asyncronously get the current animated value, we need to run stopAnimation:\n      position.stopAnimation(value => {\n        // If the speed of the gesture release is significant, use that as the indication\n        // of intent\n        if (gestureVelocity < -0.5) {\n          this.props.onGestureCanceled && this.props.onGestureCanceled();\n          this._reset(immediateIndex, resetDuration);\n          return;\n        }\n        if (gestureVelocity > 0.5) {\n          this.props.onGestureFinish && this.props.onGestureFinish();\n          this._goBack(immediateIndex, goBackDuration);\n          return;\n        }\n\n        // Then filter based on the distance the screen was moved. Over a third of the way swiped,\n        // and the back will happen.\n        if (value <= index - POSITION_THRESHOLD) {\n          this.props.onGestureFinish && this.props.onGestureFinish();\n          this._goBack(immediateIndex, goBackDuration);\n        } else {\n          this.props.onGestureCanceled && this.props.onGestureCanceled();\n          this._reset(immediateIndex, resetDuration);\n        }\n      });\n    }\n  });\n\n  _onFloatingHeaderLayout = e => {\n    this.setState({ floatingHeaderHeight: e.nativeEvent.layout.height });\n  };\n\n  render() {\n    let floatingHeader = null;\n    const headerMode = this._getHeaderMode();\n\n    if (headerMode === 'float') {\n      const { scene } = this.props.transitionProps;\n      floatingHeader = <View pointerEvents=\"box-none\" onLayout={this._onFloatingHeaderLayout}>\n          {this._renderHeader(scene, headerMode)}\n        </View>;\n    }\n    const {\n      transitionProps: { scene, scenes }\n    } = this.props;\n    const { options } = scene.descriptor;\n\n    const gesturesEnabled = typeof options.gesturesEnabled === 'boolean' ? options.gesturesEnabled : Platform.OS === 'ios';\n\n    const responder = !gesturesEnabled ? null : this._panResponder;\n\n    const handlers = gesturesEnabled ? responder.panHandlers : {};\n    const containerStyle = [styles.container, this._getTransitionConfig().containerStyle];\n\n    return <View {...handlers} style={containerStyle}>\n        <ScreenContainer style={styles.scenes}>\n          {scenes.map(s => this._renderCard(s))}\n        </ScreenContainer>\n        {floatingHeader}\n      </View>;\n  }\n\n  _getHeaderMode() {\n    if (this.props.headerMode) {\n      return this.props.headerMode;\n    }\n    if (Platform.OS === 'android' || this.props.mode === 'modal') {\n      return 'screen';\n    }\n    return 'float';\n  }\n\n  _getHeaderLayoutPreset() {\n    const { headerLayoutPreset } = this.props;\n    if (headerLayoutPreset) {\n      if (__DEV__) {\n        if (this._getHeaderTransitionPreset() === 'uikit' && headerLayoutPreset === 'left' && Platform.OS === 'ios') {\n          console.warn(`headerTransitionPreset with the value 'ui-kit' is incompatible with headerLayoutPreset 'left'`);\n        }\n      }\n      if (HEADER_LAYOUT_PRESET_VALUES.includes(headerLayoutPreset)) {\n        return headerLayoutPreset;\n      }\n\n      if (__DEV__) {\n        console.error(`Invalid configuration applied for headerLayoutPreset - expected one of ${HEADER_LAYOUT_PRESET_VALUES.join(', ')} but received ${JSON.stringify(headerLayoutPreset)}`);\n      }\n    }\n\n    if (Platform.OS === 'android') {\n      return 'left';\n    } else {\n      return 'center';\n    }\n  }\n\n  _getHeaderTransitionPreset() {\n    // On Android or with header mode screen, we always just use in-place,\n    // we ignore the option entirely (at least until we have other presets)\n    if (Platform.OS === 'android' || this._getHeaderMode() === 'screen') {\n      return 'fade-in-place';\n    }\n\n    const { headerTransitionPreset } = this.props;\n    if (headerTransitionPreset) {\n      if (HEADER_TRANSITION_PRESET_VALUES.includes(headerTransitionPreset)) {\n        return headerTransitionPreset;\n      }\n\n      if (__DEV__) {\n        console.error(`Invalid configuration applied for headerTransitionPreset - expected one of ${HEADER_TRANSITION_PRESET_VALUES.join(', ')} but received ${JSON.stringify(headerTransitionPreset)}`);\n      }\n    }\n\n    return 'fade-in-place';\n  }\n\n  _getheaderBackTitleVisible() {\n    const { headerBackTitleVisible } = this.props;\n\n    return headerBackTitleVisible;\n  }\n\n  _renderInnerScene(scene) {\n    const { navigation, getComponent } = scene.descriptor;\n    const SceneComponent = getComponent();\n\n    const { screenProps } = this.props;\n    const headerMode = this._getHeaderMode();\n    if (headerMode === 'screen') {\n      return <View style={styles.container}>\n          <View style={styles.scenes}>\n            <SceneView screenProps={screenProps} navigation={navigation} component={SceneComponent} />\n          </View>\n          {this._renderHeader(scene, headerMode)}\n        </View>;\n    }\n    return <SceneView screenProps={screenProps} navigation={navigation} component={SceneComponent} />;\n  }\n\n  _getTransitionConfig = () => {\n    const isModal = this.props.mode === 'modal';\n\n    return TransitionConfigs.getTransitionConfig(this.props.transitionConfig, this.props.transitionProps, this.props.lastTransitionProps, isModal);\n  };\n\n  _renderCard = scene => {\n    const { screenInterpolator } = this._getTransitionConfig();\n\n    const style = screenInterpolator && screenInterpolator({ ...this.props.transitionProps, scene });\n\n    // If this screen has \"header\" set to `null` in it's navigation options, but\n    // it exists in a stack with headerMode float, add a negative margin to\n    // compensate for the hidden header\n    const { options } = scene.descriptor;\n    const hasHeader = options.header !== null;\n    const headerMode = this._getHeaderMode();\n    let marginTop = 0;\n    if (!hasHeader && headerMode === 'float') {\n      marginTop = -this.state.floatingHeaderHeight;\n    }\n\n    return <Card {...this.props.transitionProps} key={`card_${scene.key}`} style={[style, { marginTop }, this.props.cardStyle]} scene={scene}>\n        {this._renderInnerScene(scene)}\n      </Card>;\n  };\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    // Header is physically rendered after scenes so that Header won't be\n    // covered by the shadows of the scenes.\n    // That said, we'd have use `flexDirection: 'column-reverse'` to move\n    // Header above the scenes.\n    flexDirection: 'column-reverse'\n  },\n  scenes: {\n    flex: 1\n  }\n});\n\nexport default withOrientation(StackViewLayout);"]},"metadata":{},"sourceType":"module"}